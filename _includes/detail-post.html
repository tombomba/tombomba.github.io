{% assign p = include.page -%}
{% assign copy = include.content | strip | normalize_whitespace -%}

{% include --fix-widows.html title=p.title -%}
{% include --fix-images.html -%}

{% assign wc = copy | strip | normalize_whitespace | number_of_words -%}

{% if copy contains 'img' %}
  {% assign hedsize = 'feature' %}
{% else %}
  {% if wc >=150 %}
    {% assign hedsize = 'supa' %}
  {% else %}
    {% assign hedsize = 'post' %}
  {% endif -%}
{% endif -%}
{% if p.image %}
  {% assign hedsize = 'post' %}
{% endif -%}

<article><!-- {{ copy | number_of_words }} -->

    <header>
      <h1 class="{{ hedsize }}">{% if include.is_home %}<a href="{{ p.url | prepend: site.url }}">{{ titlef }}</a>{% else %}{{ titlef }}{% endif %}</h1>
      {% if p.date %}
      <div class="byline">
        {% if wc > 150 %}<p>{{ p.author | default: site.author }}</p>{% endif %}
        <p><time pubdate datetime="{{ p.date | date: "%FT%T%:z" }}">{{ p.date | date: "%d %b %Y" }}</time></p>
      </div>
      {% endif -%}
    </header>

  {{ copy }}

</article>
