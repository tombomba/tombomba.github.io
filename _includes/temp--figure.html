{% if p.media %}
  {% assign w = p.media.width | default: 800 | times: 1.0 -%}
  {% assign h = p.media.height | default: 450 | times: 1.0 -%}
  {% assign percent = h | divided_by: w | times: 100 | round: 2 -%}
  <figure><!-- {{ w }} x {{ h }} | {{ percent }}% -->
    <div class="wrap" style="padding-bottom:{{ percent }}%">
      {% if p.media.vimeo %}
      <iframe src="https://player.vimeo.com/video/{{ p.media.vimeo }}?badge=0&color=0000FF&title=0&byline=0&portrait=0" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
      {% elsif p.media.youtube %}
      <iframe src="https://www.youtube.com/embed/{{ p.media.youtube }}?modestbranding=1&rel=0" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
      {% elsif p.media.image %}<img src="{{ p.media.image | prepend: site.img_dir }}" alt="{{ p.media.alt | strip_html | strip | normalize_whitespace | truncate: 140 }}">
      {% endif -%}
    </div>
    {% if p.media.caption %}<figcaption>{{ p.media.caption | strip | smartify | markdownify | normalize_whitespace }}</figcaption>{% endif -%}
  </figure>
{% endif -%}

.wrap
  position: relative
  padding-bottom: 56.25%
  height: 0
  overflow: hidden
  max-width: 100%
  background-color: $bg-color
  iframe,
  object,
  embed,
  img
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%
  iframe,
  object,
  embed
    background: $bg-color url(/assets/img/default-image-icon.png) no-repeat center center
  img
    padding: 0
    margin: 0
    box-sizing: border-box
    border: 1px solid #000
