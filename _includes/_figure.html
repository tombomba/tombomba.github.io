{% assign myfig = include.image.style | split: ' ' -%}
{% assign figstyle = myfig[0] | strip -%}

{% if figstyle == 'wide' %}

  {% assign mw = myfig[1] | default: 640 | times: 1.0 -%}
  {% assign mh = myfig[2] | default: 480 | times: 1.0 -%}
  {% if mw > 0 and mh > 0 %}
    {% assign xratio = mh | divided_by: mw | times: 100 | round: 2 %}
  {% endif -%}

  <figure class="image--wide" style="--percent: {{ xratio | default: '56.25' }}%;">
  <img src="{{ include.image.file | prepend: site.img }}" class="fixed" alt="{{ include.image.alt }}">
  {% if include.image.caption %}<figcaption>{{ include.image.caption }}</figcaption>{% endif %}
  </figure>

{% elsif figstyle == 'narrow' -%}

  {% assign figratio = myfig[1] | strip -%}
  {% assign figfloat = myfig[2] | strip -%}
  {% assign figfx    = myfig[3] | strip -%}

  <figure class="image--narrow {{ figfloat | default: 'right' }} {{ figfx | default: 'nofx' }}">
  <img src="{{ include.image.file | prepend: site.img }}" class="{{ figratio | default: 'square' }}--narrow" alt="{{ include.image.alt }}">
  </figure>

{% endif -%}